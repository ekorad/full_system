ARTIFACT := transmitter

BASE_PROJ_DIR := ./../..

SRC_DIR := src
INC_DIR := include
BIN_DIR := bin

DEPS_DIR := deps
DEPS_SRC_DIR := $(BASE_PROJ_DIR)/$(DEPS_DIR)/$(SRC_DIR)
DEPS_INC_DIR := $(BASE_PROJ_DIR)/$(DEPS_DIR)/$(INC_DIR)

DEPS_SRC_FILES := $(wildcard $(DEPS_SRC_DIR)/*.cpp)
OWN_SRC_FILES := $(wildcard $(SRC_DIR)/*.cpp)
SRC_FILES := $(DEPS_SRC_FILES) $(OWN_SRC_FILES)

INC_FLAGS := -I$(INC_DIR) -I$(DEPS_INC_DIR)
CXX_VER_FLAG := -std=c++17
DEF_FLAGS := -DMODEL=system_transmitter -DNUMST=2 -DNCSTATES=6 -DHAVESTDIO
DEF_FLAGS += -DMODEL_HAS_DYNAMICALLY_LOADED_SFCNS=0 -DCLASSIC_INTERFACE=0
DEF_FLAGS += -DALLOCATIONFCN=0 -DTID01EQ=1 -DTERMFCN=1 -DONESTEPFCN=1 -DMAT_FILE=0
DEF_FLAGS += -DMULTI_INSTANCE_CODE=0 -DINTEGER_CODE=0 -DMT=0

CXXFLAGS := $(CXX_VER_FLAG) $(DEF_FLAGS) $(INC_FLAGS)
CXXFLAGS += -pthread

.PHONY: all clean

all: $(ARTIFACT)

$(ARTIFACT): $(SRC_FILES)
	g++ $(CXXFLAGS) $^ -o $@

clean:
	$(RM) $(ARTIFACT)